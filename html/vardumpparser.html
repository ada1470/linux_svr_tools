<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>var_dump Parser</title>
<style>
    textarea {
        width: 100%;
        height: 200px;
    }
</style>
</head>
<body>

<h2>var_dump Parser</h2>

<textarea id="input" placeholder="Enter var_dump output here..."></textarea><br>
<button onclick="parseVarDump()">Parse var_dump</button><br><br>

<h3>Parsed Output:</h3>
<textarea id="output" readonly></textarea><br>
<button onclick="copyToClipboard()">Copy to Clipboard</button>

<script>
function parseVarDump() {
    var varDumpInput = document.getElementById("input").value;
    var parsedData = parseVarDumpOutput(varDumpInput);
    document.getElementById("output").value = JSON.stringify(parsedData, null, 2);
}

function parseVarDumpOutput(varDumpOutput) {
    var parsedData = {};
    var lines = varDumpOutput.trim().split('\n');
    var stack = [];
    var currentIndentation = 0;

    for (var i = 0; i < lines.length; i++) {
        var line = lines[i].trim();

        // Adjust indentation based on the stack depth
        var indentation = '';
        for (var j = 0; j < currentIndentation; j++) {
            indentation += '\t';
        }

        // Check if it's a new variable declaration line
        var declarationMatch = line.match(/^(array|string|int|float|bool)\((\d+)\) \{(.*)\}/);
        if (declarationMatch) {
            var dataType = declarationMatch[1];
            var length = parseInt(declarationMatch[2]);
            var content = declarationMatch[3].trim();
            var key = null;

            // Extract key if it's not an array
            if (dataType !== "array") {
                var keyMatch = content.match(/^\["?([^"\]]+)"?\]=>/);
                if (keyMatch) {
                    key = keyMatch[1];
                    content = content.substring(keyMatch[0].length).trim();
                }
            }

            // Parse content
            if (dataType === "array") {
                parsedData[key] = parseArray(content);
            } else {
                parsedData[key] = parseValue(dataType, content);
            }
        }
    }

    return parsedData;
}

function parseArray(arrayContent) {
    var arrayData = {};
    var lines = arrayContent.split('\n');

    for (var i = 0; i < lines.length; i++) {
        var line = lines[i].trim();
        if (line.startsWith("{") || line.startsWith("[")) {
            var openingBracket = line[0];
            var content = line.slice(1, -1).trim(); // Remove brackets
            var key = null;
            if (openingBracket === '[') {
                var keyMatch = content.match(/^\["?([^"\]]+)"?\]=>/);
                if (keyMatch) {
                    key = keyMatch[1];
                    content = content.substring(keyMatch[0].length).trim();
                }
            }
            arrayData[key] = parseArray(content);
        } else {
            var parts = line.split('=>');
            if (parts.length === 2) {
                var key = parts[0].trim();
                var value = parts[1].trim();
                arrayData[key] = parseValue(value);
            }
        }
    }

    return arrayData;
}

function parseValue(value) {
    // Handle different data types
    if (/^int\(/.test(value)) {
        return parseInt(value.substring(4));
    } else if (/^float\(/.test(value)) {
        return parseFloat(value.substring(6));
    } else if (/^string\(/.test(value)) {
        return value.substring(value.indexOf('"') + 1, value.lastIndexOf('"'));
    } else if (/^bool\((true|false)\)/.test(value)) {
        return value === "bool(true)";
    }
    return value;
}


function copyToClipboard() {
    var copyText = document.getElementById("output");
    copyText.select();
    copyText.setSelectionRange(0, 99999); /* For mobile devices */
    document.execCommand("copy");
    alert("Copied the text: " + copyText.value);
}
</script>

</body>
</html>
